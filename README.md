# Smart Jotter - AI-Powered Booking Input System

> **Generated by AgenticOS MK Agents** - This codebase was autonomously created by a multi-agent AI system (MK1-MK5) running on Modal cloud infrastructure.

Smart Jotter is a Next.js component that converts handwritten notes or typed text into structured booking data for the AUTOW automotive repair booking system.

## Features

- **Canvas Mode**: Draw handwritten notes directly in the browser
- **Text Mode**: Type or paste notes for instant parsing
- **OCR Processing**: Converts handwriting to text using MyScript API
- **AI Parsing**: Extracts structured booking data using OpenAI GPT-4
- **Preview & Edit**: Review parsed data before creating bookings
- **Mock Fallbacks**: Works without API keys for development/testing

## Quick Start

### 1. Install Dependencies

```bash
cd smart-jotter-output
npm install
```

### 2. Configure Environment

Copy the example environment file:

```bash
cp .env.local.example .env.local
```

Edit `.env.local` with your API keys:

```env
# OpenAI - Required for AI text parsing
OPENAI_API_KEY=sk-your-openai-key

# MyScript - Required for handwriting OCR (optional - has mock fallback)
MYSCRIPT_APPLICATION_KEY=your-myscript-app-key
MYSCRIPT_HMAC_KEY=your-myscript-hmac-key
```

### 3. Run Development Server

```bash
npm run dev
```

Open [http://localhost:3000/autow/jotter](http://localhost:3000/autow/jotter)

## Architecture

```
                         Smart Jotter UI
+------------------------------------------------------------------+
|  +-------------+    +-------------+    +---------------------+   |
|  | Canvas Mode |    |  Text Mode  |    | Parsed Data Preview |   |
|  | (Drawing)   |    |  (Typing)   |    | (Review & Edit)     |   |
|  +------+------+    +------+------+    +---------------------+   |
|         |                  |                                     |
|         v                  |                                     |
|  +-------------+           |                                     |
|  | OCR API     |           |                                     |
|  | /api/ocr    +-----------+                                     |
|  +------+------+           |                                     |
|         |                  |                                     |
|         v                  v                                     |
|  +-------------------------------------+                         |
|  |       Parse API                     |                         |
|  |       /api/parse                    |                         |
|  |   (OpenAI GPT-4 Extraction)         |                         |
|  +------------------+------------------+                         |
|                     |                                            |
|                     v                                            |
|  +-------------------------------------+                         |
|  |     ParsedBookingData               |                         |
|  |  - customer_name                    |                         |
|  |  - phone                            |                         |
|  |  - vehicle, year, registration      |                         |
|  |  - issue                            |                         |
|  +-------------------------------------+                         |
+------------------------------------------------------------------+
```

## File Structure

```
smart-jotter-output/
├── app/
│   ├── autow/
│   │   └── jotter/
│   │       └── page.tsx              # Main Smart Jotter page
│   └── api/
│       └── autow/
│           └── jotter/
│               ├── recognize/
│               │   └── route.ts      # OCR API (MyScript)
│               └── parse/
│                   └── route.ts      # AI parsing API (OpenAI)
├── components/
│   └── smart-jotter/
│       ├── SmartJotter.tsx           # Main component
│       ├── InputSection.tsx          # Canvas/Text input UI
│       ├── CanvasInput.tsx           # Drawing canvas
│       ├── TextInput.tsx             # Text input area
│       ├── ProcessingStatus.tsx      # Loading states
│       ├── ParsedDataPreview.tsx     # Data preview
│       └── ActionButtons.tsx         # Create booking/estimate
├── types/
│   └── smart-jotter.ts               # TypeScript interfaces
├── .env.local.example                # Environment template
└── package.json                      # Dependencies
```

## API Endpoints

### POST /api/autow/jotter/recognize

Converts handwriting image to text using OCR.

**Request:**
```json
{
  "imageData": "data:image/png;base64,..."
}
```

**Response:**
```json
{
  "success": true,
  "text": "John Smith 07123456789 Ford Focus AB12 CDE",
  "confidence": 0.92
}
```

### POST /api/autow/jotter/parse

Extracts structured booking data from text using AI.

**Request:**
```json
{
  "text": "John Smith 07123456789 Ford Focus 2019 AB12 CDE engine warning light"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "customer_name": "John Smith",
    "phone": "07123456789",
    "vehicle": "Ford Focus",
    "year": "2019",
    "registration": "AB12 CDE",
    "issue": "Engine warning light",
    "confidence_score": 0.95
  }
}
```

## Integration with AUTOW Booking

When the user clicks "Create Booking", the parsed data is passed to the booking form:

```typescript
// Navigation with pre-filled data
router.push(`/autow/booking?${params.toString()}`);

// URL parameters:
// - customer_name
// - phone
// - vehicle
// - year
// - registration
// - issue
// - from_jotter=true
```

## Testing Without API Keys

Both APIs have mock fallbacks for development:

1. **OCR Mock**: Returns sample text based on input patterns
2. **Parse Mock**: Uses regex patterns to extract common fields

Run in mock mode:
```bash
# Don't set API keys - mocks will be used automatically
npm run dev
```

You'll see console warnings: `OPENAI_API_KEY not found, using mock response`

## Dependencies

| Package | Version | Purpose |
|---------|---------|---------|
| next | 14.0.0 | React framework |
| react | ^18.0.0 | UI library |
| openai | ^4.20.0 | GPT-4 API client |
| zod | ^3.22.0 | Schema validation |
| tailwindcss | ^3.3.0 | Styling |

## Type Definitions

```typescript
interface ParsedBookingData {
  customer_name?: string;
  phone?: string;
  vehicle?: string;
  year?: string;
  registration?: string;
  issue?: string;
  confidence_score?: number;
}

type ProcessingStep = 'input' | 'ocr' | 'parsing' | 'preview' | 'error';
```

## Development

```bash
# Type checking
npm run type-check

# Linting
npm run lint

# Build for production
npm run build

# Start production server
npm start
```

## Deployment

### Vercel (Recommended)

1. Push to GitHub
2. Import in Vercel
3. Add environment variables in Vercel dashboard
4. Deploy

### Docker

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build
EXPOSE 3000
CMD ["npm", "start"]
```

## AgenticOS Generation Info

This code was generated by the AgenticOS multi-agent system:

| Agent | Role | Tasks Completed |
|-------|------|-----------------|
| MK1 (Coordinator) | Task orchestration | Project setup |
| MK2 (Research) | Technical research | 4 research tasks |
| MK3 (Implementation) | Code generation | 7 implementation tasks |
| MK4 (Testing) | Test creation | 4 testing tasks |
| MK5 (Documentation) | Documentation | 3 documentation tasks |

**Total: 18 tasks completed autonomously**

## License

Generated code - use freely for AUTOW Services.

---

*Generated by AgenticOS MK Agents on 2026-01-05*
